{"version":3,"sources":["../../src/utils/convert-to-response.js"],"names":["convertToResponse","schema","fields","convertOuts","properties","result","constructor","name","callback","key","value"],"mappings":";;;;;;;;kBAGwBA,iB;;AAHxB;;;;AACA;;;;;;AAEe,SAASA,iBAAT,CAA2BC,MAA3B,EAAmCC,MAAnC,EAA2C;AACxD,QAAMC,cAAc,+BAAgBF,OAAOG,UAAvB,CAApB;;AAEA,SAAOC,UAAU;AACf,QAAI,sBAAcA,MAAd,KAAyBA,OAAOC,WAAP,CAAmBC,IAAnB,KAA4B,WAAzD,EAAsE;AACpE,uBAA+BJ,WAA/B,EAA4C;AAAA,YAAjCI,IAAiC,QAAjCA,IAAiC;AAAA,YAA3BC,QAA2B,QAA3BA,QAA2B;;AAC1CH,eAAQE,IAAR,IAAiBC,SAASH,OAAQE,IAAR,CAAT,EAAyBN,OAAOG,UAAP,CAAmBG,IAAnB,CAAzB,CAAjB;AACD;;AAED,0BAAYF,MAAZ;AACD,KAND,MAMO;AACL,UAAII,MAAMP,OAAQ,CAAR,CAAV;AACA,UAAIQ,QAAQL,OAAQ,CAAR,KAAeA,MAA3B;;AAEA,wBAA+BF,WAA/B,EAA4C;AAAA,YAAjCI,IAAiC,SAAjCA,IAAiC;AAAA,YAA3BC,QAA2B,SAA3BA,QAA2B;;AAC1C,YAAIC,QAAQF,IAAZ,EAAkB;AAChBG,kBAAQF,SAASE,KAAT,EAAgBT,OAAOG,UAAP,CAAmBG,IAAnB,CAAhB,CAAR;AACA;AACD;AACF;;AAED,aAAO,EAAE,CAAEE,GAAF,GAASC,KAAX,EAAP;AACD;AACF,GApBD;AAqBD","file":"convert-to-response.js","sourcesContent":["import isPlainObject from 'lodash.isplainobject';\nimport checkConvertOut from './check-convert-out';\n\nexport default function convertToResponse(schema, fields) {\n  const convertOuts = checkConvertOut(schema.properties);\n\n  return result => {\n    if (isPlainObject(result) || result.constructor.name === 'anonymous') {\n      for (let { name, callback } of convertOuts) {\n        result[ name ] = callback(result[ name ], schema.properties[ name ]);\n      }\n\n      return { ...result };\n    } else {\n      let key = fields[ 0 ];\n      let value = result[ 0 ] || result;\n\n      for (let { name, callback } of convertOuts) {\n        if (key === name) {\n          value = callback(value, schema.properties[ name ]);\n          break;\n        }\n      }\n\n      return { [ key ]: value };\n    }\n  };\n}"]}