{"version":3,"sources":["../../../../src/utils/schema-types/types/string.js"],"names":["value","schema","schemaValidate","options","Object","create","string","truncate","length","max","Array","isArray","enum","valid","insensitive","reduce","name"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;kBAEe;AACbA,SAAQ,QADK;AAEbC,UAAQ,sBAAQC,cAAR;AAFK,C;;;AAKf,SAASA,cAAT,GAAuD;AAAA,MAA/BC,OAA+B,uEAArBC,OAAOC,MAAP,CAAc,IAAd,CAAqB;;AACrD,MAAIJ,SAAS,cAAIK,MAAJ,EAAb;;AADqD,QAG7CC,QAH6C,GAGnBJ,OAHmB,CAG7CI,QAH6C;AAAA,QAGnCC,MAHmC,GAGnBL,OAHmB,CAGnCK,MAHmC;AAAA,QAG3BC,GAH2B,GAGnBN,OAHmB,CAG3BM,GAH2B;;;AAKrD,MAAI,YAAYN,OAAZ,IAAuB,sBAASK,MAAT,CAAvB,IAA2CA,UAAU,CAAzD,EAA4D;AAC1DP,aAASA,OAAOO,MAAP,CAAc,CAACA,MAAf,EAAuB,MAAvB,CAAT;AACD,GAFD,MAEO;AACLP,aAAS,2BAAYE,OAAZ,EAAqBF,MAArB,CAAT;;AAEA,QAAI,SAASE,OAAT,IAAoB,sBAASM,GAAT,CAAxB,EAAuC;AACrC,UAAI,cAAcN,OAAd,IAAyBI,aAAa,IAA1C,EAAgD;AAC9CN,iBAASA,OAAOM,QAAP,EAAT;AACD;AACF;AACF;;AAED,MAAI,UAAUJ,OAAV,IAAqBO,MAAMC,OAAN,CAAcR,QAAQS,IAAtB,CAAzB,EAAsD;AACpDX,aAASA,OAAOY,KAAP,CAAaV,QAAQS,IAArB,EAA2BE,WAA3B,EAAT;AACD;;AAEDb,WAAS,CAAE,MAAF,EAAU,WAAV,EAAuB,WAAvB,EAAqCc,MAArC,CAA4C,CAACd,MAAD,EAASe,IAAT,KAAkB;AACrE,QAAIA,QAAQb,OAAR,IAAmBA,QAASa,IAAT,MAAoB,IAA3C,EAAiD;AAC/Cf,eAASA,OAAQe,IAAR,GAAT;AACD;AACD,WAAOf,MAAP;AACD,GALQ,EAKNA,MALM,CAAT;;AAOA,SAAO,+BAAgBE,OAAhB,EAAyBF,MAAzB,EAAiC,6CAAjC,CAAP;AAID","file":"string.js","sourcesContent":["import Joi from 'joi';\nimport memoize from 'lodash.memoize';\nimport applyValidators from '../utils/apply-validators';\nimport setDefault from '../utils/validators/set-default';\nimport setMinMax from '../utils/validators/set-min-max';\nimport setRequired from '../utils/validators/set-required';\nimport isNumber from 'lodash.isnumber';\n\nexport default {\n  value : 'string',\n  schema: memoize(schemaValidate)\n};\n\nfunction schemaValidate(options = Object.create(null)) {\n  let schema = Joi.string();\n\n  const { truncate, length, max } = options;\n\n  if ('length' in options && isNumber(length) && length >= 0) {\n    schema = schema.length(+length, 'utf8');\n  } else {\n    schema = setMinMax()(options, schema);\n\n    if ('max' in options && isNumber(max)) {\n      if ('truncate' in options && truncate === true) {\n        schema = schema.truncate();\n      }\n    }\n  }\n\n  if ('enum' in options && Array.isArray(options.enum)) {\n    schema = schema.valid(options.enum).insensitive();\n  }\n\n  schema = [ 'trim', 'lowercase', 'uppercase' ].reduce((schema, name) => {\n    if (name in options && options[ name ] === true) {\n      schema = schema[ name ]();\n    }\n    return schema;\n  }, schema);\n\n  return applyValidators(options, schema, [\n    setDefault,\n    setRequired\n  ]);\n}"]}