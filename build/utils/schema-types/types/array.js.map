{"version":3,"sources":["../../../../src/utils/schema-types/types/array.js"],"names":["value","convertIn","convertOut","schema","schemaValidate","options","Object","create","string","Array","isArray","result","filter","filterIterator","join","undefined","split","map","id","raw"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;kBAEe;AACbA,SAAQ,OADK;AAEbC,WAFa;AAGbC,YAHa;AAIbC,UAAQ,sBAAQC,cAAR;AAJK,C;;;AAOf,SAASA,cAAT,GAAuD;AAAA,MAA/BC,OAA+B,uEAArBC,OAAOC,MAAP,CAAc,IAAd,CAAqB;;AACrD,MAAIJ,SAAS,cAAIK,MAAJ,EAAb;;AAEA,SAAO,+BAAgBH,OAAhB,EAAyBF,MAAzB,EAAiC,6CAAjC,CAAP;AAID;;AAED,SAASF,SAAT,CAAmBD,KAAnB,EAA0B;AACxB,MAAIS,MAAMC,OAAN,CAAcV,KAAd,CAAJ,EAA0B;AACxB,QAAIW,SAASX,MACVY,MADU,CACHC,cADG,EAEVC,IAFU,CAEL,GAFK,CAAb;;AAIA,QAAI,sBAASH,MAAT,KAAoBA,WAAW,EAAnC,EAAuC;AACrCA,eAAS,IAAT;AACD;;AAED,WAAOA,MAAP;AACD;;AAED,SAAOX,KAAP;AACD;;AAED,SAASE,UAAT,CAAoBF,KAApB,EAA2B;AACzB,MAAI,sBAASA,KAAT,CAAJ,EAAqB;AACnB,WAAOA,UAAU,EAAV,GAAee,SAAf,GAA2Bf,MAAMgB,KAAN,CAAY,GAAZ,EAAiBC,GAAjB,CAAqBC,MAAM,CAACA,EAA5B,CAAlC;AACD;;AAED,SAAOlB,KAAP;AACD;;AAED,SAASa,cAAT,CAAwBM,GAAxB,EAA6B;AAC3B,MAAI,sBAAcA,GAAd,CAAJ,EAAwB;AACtBA,UAAMA,IAAID,EAAV;AACD;;AAED,MAAI,sBAASC,GAAT,CAAJ,EAAmB;AACjB,WAAOA,GAAP;AACD;;AAED,SAAO,KAAP;AACD","file":"array.js","sourcesContent":["import Joi from 'joi';\nimport memoize from 'lodash.memoize';\nimport isPlainObject from 'lodash.isplainobject';\nimport isString from 'lodash.isstring';\nimport applyValidators from '../utils/apply-validators';\nimport setDefault from '../utils/validators/set-default';\nimport setRequired from '../utils/validators/set-required';\nimport isNumber from 'lodash.isnumber';\n\nexport default {\n  value : 'array',\n  convertIn,\n  convertOut,\n  schema: memoize(schemaValidate)\n};\n\nfunction schemaValidate(options = Object.create(null)) {\n  let schema = Joi.string();\n\n  return applyValidators(options, schema, [\n    setDefault,\n    setRequired\n  ]);\n}\n\nfunction convertIn(value) {\n  if (Array.isArray(value)) {\n    let result = value\n      .filter(filterIterator)\n      .join(',');\n\n    if (isString(result) && result === '') {\n      result = null;\n    }\n\n    return result;\n  }\n\n  return value;\n}\n\nfunction convertOut(value) {\n  if (isString(value)) {\n    return value === '' ? undefined : value.split(',').map(id => +id);\n  }\n\n  return value;\n}\n\nfunction filterIterator(raw) {\n  if (isPlainObject(raw)) {\n    raw = raw.id;\n  }\n\n  if (isNumber(raw)) {\n    return raw;\n  }\n\n  return false;\n}"]}