{"version":3,"sources":["../../src/utils/set-params.js"],"names":["ERROR_INFO","module","action","app","schema","params","reject","keys","Object","result","property","value","has","valid","validate","error"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;AAEA,MAAMA,aAAa,EAAEC,QAAQ,OAAV,EAAmBC,QAAQ,YAA3B,EAAnB;;kBAEe,CAACC,GAAD,EAAMC,MAAN,EAAcC,MAAd,EAAsBC,MAAtB,KAAiC;AAC9C,QAAMC,OAAOC,OAAOD,IAAP,CAAYF,MAAZ,CAAb;AACA,QAAMI,SAAS,EAAf;;AAEA,OAAI,IAAIC,QAAR,IAAoBH,IAApB,EAA0B;AACxB,UAAMI,QAAQN,OAAQK,QAAR,CAAd;;AAEA,QAAI,CAAC,kCAAmBC,KAAnB,CAAL,EAAgC;AAC9BL,aAAO,uCAA0BH,GAA1B,eAAoCH,UAApC,IAAgDU,QAAhD,EAA0DC,KAA1D,IAAP;AACA;AACD;;AAED,QAAI,CAACP,OAAOQ,GAAP,CAAWF,QAAX,CAAL,EAA2B;AACzB;AACD;;AAED,QAAIG,QAAQT,OAAOU,QAAP,CAAgBJ,QAAhB,EAA0BC,KAA1B,CAAZ;;AAEA,QAAIE,MAAME,KAAV,EAAiB;AACfT,aAAOO,MAAME,KAAb;AACA;AACD;;AAEDN,WAAQC,QAAR,IAAqBG,MAAMF,KAA3B;AACD;;AAED,SAAOF,MAAP;AACD,C","file":"set-params.js","sourcesContent":["import sqlStringProtector from './sql-string-protector';\nimport { detectedSqlInjectionError } from './../errors';\n\nconst ERROR_INFO = { module: 'utils', action: 'set-params' };\n\nexport default (app, schema, params, reject) => {\n  const keys = Object.keys(params);\n  const result = {};\n  \n  for(let property of keys) {\n    const value = params[ property ];\n    \n    if (!sqlStringProtector(value)) {\n      reject(detectedSqlInjectionError(app, { ...ERROR_INFO, property, value }));\n      break;\n    }\n\n    if (!schema.has(property)) {\n      continue;\n    }\n    \n    let valid = schema.validate(property, value);\n    \n    if (valid.error) {\n      reject(valid.error);\n      break;\n    }\n    \n    result[ property ] = valid.value;\n  }\n  \n  return result;\n};"]}